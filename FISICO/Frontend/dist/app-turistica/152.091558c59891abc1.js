"use strict";(self.webpackChunkAppTuristica=self.webpackChunkAppTuristica||[]).push([[152],{2152:(B,d,n)=>{n.r(d),n.d(d,{RolesModule:()=>U});var p=n(9808),a=n(2382),m=n(1813),e=n(7587);let y=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-crear"]],decls:2,vars:0,template:function(t,i){1&t&&(e.TgZ(0,"p"),e._uU(1,"crear works!"),e.qZA())},styles:[""]}),r})();var Z=n(2340),T=n(7180),c=n(9783),u=n(845),g=n(6697),h=n(7307),f=n(1424),b=n(657),v=n(1497),_=n(5315);function x(r,o){1&r&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Id"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Acciones"),e.qZA(),e.qZA())}function A(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"p-confirmPopup"),e.TgZ(7,"button",17),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw(2).showEditar(l.id)}),e.qZA(),e.TgZ(8,"button",18),e.NdJ("click",function(s){const C=e.CHM(t).$implicit;return e.oxw(2).confirm(s,C.id)}),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=o.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.name),e.xp6(3),e.Q6J("disabled",!i.banderaBtnEdit),e.xp6(1),e.Q6J("disabled",!i.banderaBtnEdit)}}const R=function(){return{"min-width":"20rem"}};function S(r,o){if(1&r&&(e.TgZ(0,"p-table",14),e.YNc(1,x,7,0,"ng-template",15),e.YNc(2,A,9,4,"ng-template",16),e.qZA()),2&r){const t=e.oxw();e.Q6J("value",t.roles)("tableStyle",e.DdM(2,R))}}function E(r,o){1&r&&e._UZ(0,"i",19)}function M(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"div",20),e.TgZ(2,"h3",11),e._uU(3,"Editar"),e.qZA(),e.TgZ(4,"input",21),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().name=s}),e.qZA(),e.TgZ(5,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().editar()}),e.qZA(),e.TgZ(6,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().cancelar()}),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.name)("pKeyFilter",t.blockSpecial)}}const I=function(){return{width:"40vw",height:"40vh"}},J=[{path:"ver",component:(()=>{class r{constructor(t,i,s,l){this.adminService=t,this.fb=i,this.messageService=s,this.confirmationService=l,this.API_URI=Z.N.API_URI,this.roles=[],this.verificarRoles=[],this.token="",this.display=!1,this.displayEditar=!1,this.idSelected=null,this.banderaBtnEdit=!0,this.blockSpecial=/^[^<>*!@.,]+$/,this.form=this.fb.group({name:["",a.kI.required]}),this.name=""}ngOnInit(){this.token=localStorage.getItem("token"),this.traerDatos()}traerDatos(){this.roles=[],this.verificarRoles=[],this.adminService.getAllRoles(`${this.API_URI}/roles`,this.token).subscribe(t=>{this.roles=t.data,t.data.map(i=>this.verificarRoles.push(i.name.toLowerCase()))})}submit(){if(this.verificarRoles.includes(this.form.value.name.toLowerCase()))return this.messageService.add({severity:"error",summary:"Error",detail:"Este rol ya existe"});try{this.adminService.createRol(`${this.API_URI}/roles/create/`,this.form.value,this.token).subscribe(t=>{this.roles.push({id:t.data.id,name:t.data.name}),this.traerDatos(),this.showDialog(),this.form.reset(),this.messageService.add({severity:"success",summary:"Success",detail:"Rol guardado"})})}catch(t){this.messageService.add({severity:"error",summary:"Error",detail:`${t.errors.error}`}),console.log(t)}}showDialog(){this.display=!this.display}showEditar(t){this.idSelected=t,this.banderaBtnEdit=!1,this.roles.map(i=>{i.id===t&&(this.name=i.name)}),this.displayEditar=!this.displayEditar,console.log(t),console.log(this.form.value.name)}editar(){try{this.adminService.editRol(`${this.API_URI}/roles/update/${this.idSelected}`,{name:this.name},this.token).subscribe(t=>console.log(t)),this.messageService.add({severity:"success",summary:"Success",detail:"Rol editado correctamente"}),this.traerDatos(),this.displayEditar=!1,this.banderaBtnEdit=!this.banderaBtnEdit}catch(t){this.messageService.add({severity:"error",summary:"Error",detail:`${t.errors.error}`})}}cancelar(){this.banderaBtnEdit=!this.banderaBtnEdit,this.displayEditar=!1}eliminar(t){try{this.adminService.deleteRol(`${this.API_URI}/roles/delete/${t}`,this.token).subscribe(i=>{i.ok&&(this.messageService.add({severity:"success",summary:"Success",detail:"Rol eliminado"}),this.traerDatos())})}catch(i){this.messageService.add({severity:"error",summary:"Error",detail:"Problemas con la consulta."})}console.log(t)}confirm(t,i){this.confirmationService.confirm({target:t.target,message:"\xbfEsta seguro que desea eliminar este rol?",icon:"pi pi-exclamation-triangle",accept:()=>{this.eliminar(i)},reject:()=>{}})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(T.l),e.Y36(a.qu),e.Y36(c.ez),e.Y36(c.YP))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-ver"]],decls:18,vars:13,consts:[[1,"grid","p-6"],[1,"col-12","md:col-12","lg:col-12"],[1,"col-12","md:col-8","lg:col-4"],["id","btnCrear","pButton","","pRipple","","type","submit","label","Crear rol",3,"click"],[1,"col-12","md:col-12","lg:col-6"],[3,"value","tableStyle",4,"ngIf","ngIfElse"],["elseBlock",""],["class","grid dialog-form-crear col-12 md:col-12 lg:col-12",4,"ngIf"],["header","Crear recuerso",3,"visible","modal","draggable","resizable","visibleChange"],[1,"grid","dialog-form-crear","col-12","md:col-12","lg:col-12"],[3,"formGroup","submit"],[1,"my-3"],["type","text","pInputText","","placeholder","Nombre","formControlName","name",1,"my-3",3,"pKeyFilter"],["id","btnCrear","pButton","","pRipple","","type","submit","label","Guardar",1,"p-button-success",3,"disabled"],[3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pButton","","pRipple","","type","button","icon","pi pi-pencil",1,"p-button-rounded","p-button-warning","mx-3",3,"disabled","click"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-rounded","p-button-danger","mx-3",3,"disabled","click"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2rem"],[1,"card"],["type","text","pInputText","","placeholder","Nombre",1,"my-3",3,"ngModel","pKeyFilter","ngModelChange"],["id","btnCrear","pButton","","pRipple","","label","Editar",1,"p-button-warning","my-2",3,"click"],["id","btnCrear","pButton","","pRipple","","label","Cancelar",1,"p-button","my-2",3,"click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"button",3),e.NdJ("click",function(){return i.showDialog()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(4,"div",4),e.YNc(5,S,3,3,"p-table",5),e.YNc(6,E,1,0,"ng-template",null,6,e.W1O),e.qZA(),e.TgZ(8,"div",4),e.YNc(9,M,7,2,"div",7),e.qZA(),e.qZA(),e._UZ(10,"p-toast"),e.TgZ(11,"p-dialog",8),e.NdJ("visibleChange",function(l){return i.display=l}),e.TgZ(12,"div",9),e.TgZ(13,"form",10),e.NdJ("submit",function(){return i.submit()}),e.TgZ(14,"h3",11),e._uU(15,"Crear rol"),e.qZA(),e._UZ(16,"input",12),e._UZ(17,"button",13),e.qZA(),e.qZA(),e.qZA()),2&t){const s=e.MAs(7);e.xp6(5),e.Q6J("ngIf",i.roles.length)("ngIfElse",s),e.xp6(4),e.Q6J("ngIf",i.displayEditar),e.xp6(2),e.Akn(e.DdM(12,I)),e.Q6J("visible",i.display)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("formGroup",i.form),e.xp6(3),e.Q6J("pKeyFilter",i.blockSpecial),e.xp6(1),e.Q6J("disabled",!i.form.valid)}},directives:[u.Hq,p.O5,g.iA,c.jx,h.P,a.Fj,f.o,a.JJ,a.On,b.Fr,v.FN,_.V,a._Y,a.JL,a.sg,a.u],styles:["#elseBlock[_ngcontent-%COMP%]{margin:auto}h3[_ngcontent-%COMP%]{text-align:center}form[_ngcontent-%COMP%]{margin:auto}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.pi-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]}),r})()},{path:"crear",component:y}];let k=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[m.Bz.forChild(J)],m.Bz]}),r})(),U=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[],imports:[[p.ez,k,a.u5,a.UX,g.U$,f.j,u.hJ,b.kK,v.EV,_.S,h.n]]}),r})()}}]);